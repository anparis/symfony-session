{% extends 'base.html.twig' %}

{% block title %}Liste des Sessions{% endblock %}

{% block body %}
{% if sessionsCurrent %}
<h3>Sessions passés</h3>
<table>
  <thead>
    <th>Intitulé de la session</th>
    <th>Début</th>
    <th>Fin</th>
    <th>Places théoriques</th>
    <th>Places réservées</th>
    <th>Places restantes</th>
    <th>Actions</th>
  </thead>
  <tbody>
    {% for session in sessionsCurrent %}
    <tr>
      <td><a href="{{path('show_session', {'id': session.id}) }}">{{session.titre}}</a></td>
      <td>{{session.dateDebut | date('d/m/Y')}}</td>
      <td>{{session.dateFin | date('d/m/Y') }}</td>
      <td>{{session.nbPlaces}}</td>
      {% if session.stagiaires is not empty %}
      {% for stagiaire in session.stagiaires %}
        {% if loop.last %}
        <td>{{ loop.index }}</td>
        <td>{{ session.nbPlaces - loop.index }}</td>
        {% endif %}
      {% endfor %}
      {% else %}
        <td>0</td>
        <td>{{session.nbPlaces}}</td>
      {% endif %}
      <td>Edit</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

{% if sessionsPast %}
<h3>Sessions passés</h3>
<table>
  <thead>
    <th>Intitulé de la session</th>
    <th>Début</th>
    <th>Fin</th>
    <th>Places théoriques</th>
    <th>Places réservées</th>
    <th>Places restantes</th>
    <th>Actions</th>
  </thead>
  <tbody>
    {% for session in sessionsPast %}
    <tr>
      <td><a href="{{path('show_session', {'id': session.id}) }}">{{session.titre}}</a></td>
      <td>{{session.dateDebut | date('d/m/Y')}}</td>
      <td>{{session.dateFin | date('d/m/Y') }}</td>
      <td>{{session.nbPlaces}}</td>
      {% if session.stagiaires is not empty %}
      {% for stagiaire in session.stagiaires %}
        {% if loop.last %}
        <td>{{ loop.index }}</td>
        <td>{{ session.nbPlaces - loop.index }}</td>
        {% endif %}
      {% endfor %}
      {% else %}
        <td>0</td>
        <td>{{session.nbPlaces}}</td>
      {% endif %}
      <td>Edit</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

{% if sessionsCurrent %}
<h3>Sessions à venir</h3>
<table>
  <thead>
    <th>Intitulé de la session</th>
    <th>Début</th>
    <th>Fin</th>
    <th>Places théoriques</th>
    <th>Places réservées</th>
    <th>Places restantes</th>
    <th>Actions</th>
  </thead>
  <tbody>
    {% for session in sessionsFuture %}
    <tr>
      <td><a href="{{path('show_session', {'id': session.id}) }}">{{session.titre}}</a></td>
      <td>{{session.dateDebut | date('d/m/Y')}}</td>
      <td>{{session.dateFin | date('d/m/Y') }}</td>
      <td>{{session.nbPlaces}}</td>
      {% if session.stagiaires is not empty %}
      {% for stagiaire in session.stagiaires %}
        {% if loop.last %}
        <td>{{ loop.index }}</td>
        <td>{{ session.nbPlaces - loop.index }}</td>
        {% endif %}
      {% endfor %}
      {% else %}
        <td>0</td>
        <td>{{session.nbPlaces}}</td>
      {% endif %}

      <td>Edit</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}

<br>
<a href="{{ path('add_session') }}">Ajouter une session</a>
{% endblock %}